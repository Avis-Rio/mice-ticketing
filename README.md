# 智能会务机票助手

一款基于Streamlit的桌面Web应用工具，旨在自动化处理机票预订中的信息流转，提升会务人员工作效率。

## 功能特性

- **Excel文件上传与解析**：支持上传包含专家信息的Excel文件，自动验证格式和必需列
- **专家选择与信息填充**：下拉选择专家，自动填充姓名、身份证、手机号码信息
- **询价信息生成**：输入航班需求，一键生成标准化询价文本
- **票务回复处理**：自动清洗价格和敏感信息，生成安全的确认文本
- **一键复制功能**：生成的文本支持一键复制到剪贴板

## 技术栈

- **Frontend**: Streamlit 1.48+
- **Backend**: Python 3.10+
- **数据处理**: pandas 2.3+, openpyxl 3.1+
- **文本处理**: 正则表达式 (re)

## 安装与运行

### 1. 环境准备

确保系统已安装Python 3.8或更高版本：

```bash
python3 --version
```

### 2. 创建虚拟环境

```bash
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# 或
venv\Scripts\activate     # Windows
```

### 3. 安装依赖

```bash
pip install -r requirements.txt
```

### 4. 启动应用

```bash
streamlit run app.py
```

应用将在浏览器中自动打开，默认地址为 `http://localhost:8501`

## 使用说明

### 步骤1: 上传专家信息文件

1. 准备包含专家信息的Excel文件（.xlsx格式）
2. 确保文件包含以下必需列：
   - `姓名*`
   - `身份证(出机票必须填写)`
   - `手机号码(必填)`
3. 点击上传按钮选择文件

### 步骤2: 生成询价信息

1. 从下拉列表中选择专家
2. 系统自动填充专家的基本信息
3. 在"航班需求"文本框中输入具体需求
4. 点击"生成询价信息"按钮
5. 使用"一键复制"功能复制生成的文本

### 步骤3: 处理票务回复

1. 将从票务方收到的原始回复粘贴到文本框中
2. 点击"清洗价格并生成确认信息"按钮
3. 系统自动清除价格和敏感代码信息
4. 使用"一键复制"功能复制处理后的确认文本

## 数据安全

- ✅ **本地处理**：所有数据处理均在本地完成，不发送到外部服务器
- ✅ **隐私保护**：自动清除价格和PNR码等敏感信息
- ✅ **内存存储**：数据仅在应用运行期间存储在内存中
- ✅ **无数据库**：不使用任何持久化数据库

## 文件结构

```
MICE Ticketing/
├── app.py              # 主应用文件
├── requirements.txt    # 依赖包列表
├── README.md          # 项目说明文档
├── prd.md             # 产品需求文档
├── venv/              # Python虚拟环境
└── .trae/             # 项目文档
    └── documents/
        ├── product_requirements.md
        └── technical_architecture.md
```

## 支持的文件格式

- **输入文件**: Excel (.xlsx)
- **最大文件大小**: 10MB
- **最大数据行数**: 1000行

## 常见问题

### Q: 上传文件时提示"缺少必需列"怎么办？
A: 请确保Excel文件包含以下三列，列名必须完全匹配：
- `姓名*`
- `身份证(出机票必须填写)`
- `手机号码(必填)`

### Q: 一键复制功能不工作怎么办？
A: 请确保使用现代浏览器（Chrome、Firefox、Safari、Edge），并允许网站访问剪贴板。

### Q: 应用启动失败怎么办？
A: 请检查：
1. Python版本是否为3.8+
2. 虚拟环境是否正确激活
3. 依赖包是否正确安装
4. 端口8501是否被占用

## 版本历史

- **v1.0** (2024-01-XX)
  - 初始版本发布
  - 支持Excel文件上传与解析
  - 支持询价信息生成
  - 支持票务回复处理
  - 支持一键复制功能

## 许可证

本项目仅供内部使用。
=======
# mice-ticketing
MICE智能会务票台app
>>>>>>> 7fd37ab4224a1b0358bbd35e6010ba37261e0f55
