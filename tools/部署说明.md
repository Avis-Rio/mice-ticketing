# 智能会务机票助手 - 本地化部署说明

## 📦 部署概述

本项目已配置完成基于GitHub Releases的自动更新本地化部署方案，支持将Streamlit应用打包为Windows单文件可执行程序。

## 🛠️ 部署步骤

### 1. 环境准备

确保已安装Python 3.9+和所需依赖：

```bash
# 安装依赖
pip install -r requirements.txt
```

### 2. 本地打包测试

#### 方法一：使用批处理脚本（推荐）

```bash
# 双击运行或在命令行执行
build.bat
```

#### 方法二：手动打包

```bash
# 使用PyInstaller配置文件打包
pyinstaller app.spec

# 或使用命令行参数
pyinstaller --onefile --windowed --icon=icon.ico --name="智能会务机票助手" app.py
```

### 3. 测试打包结果

打包完成后，可执行文件位于 `dist/智能会务机票助手.exe`

```bash
# 测试运行
cd dist
.\智能会务机票助手.exe
```

## 🔄 自动更新配置

### 1. GitHub仓库设置

1. 创建GitHub仓库（如果还没有）
2. 将代码推送到仓库
3. 在 `app.py` 中修改仓库信息：

```python
# 修改这一行，替换为你的GitHub用户名和仓库名
updater = AutoUpdater("your-username", "mice-ticketing")
```

### 2. 发布新版本

1. **更新版本号**：修改 `version.json` 中的版本号
2. **提交代码**：
   ```bash
   git add .
   git commit -m "发布版本 v1.1.0"
   ```
3. **创建标签**：
   ```bash
   git tag v1.1.0
   git push origin v1.1.0
   ```
4. **GitHub Actions自动构建**：推送标签后会自动触发构建和发布

### 3. 手动发布（如果不使用GitHub Actions）

1. 本地打包生成exe文件
2. 在GitHub仓库中创建新的Release
3. 上传exe文件到Release
4. 填写版本说明

## 📱 用户使用说明

### 安装使用

1. 从GitHub Releases页面下载最新的 `智能会务机票助手.exe`
2. 双击运行即可使用
3. 首次运行可能需要几秒钟启动时间

### 自动更新

1. 应用启动时会在侧边栏显示当前版本
2. 点击"🔄 检查更新"按钮检查新版本
3. 如有新版本，点击"⬇️ 立即更新"自动下载安装
4. 更新完成后应用会自动重启

## 🔧 技术细节

### 文件结构

```
project/
├── app.py                    # 主应用程序
├── auto_updater.py          # 自动更新模块
├── version.json             # 版本配置
├── app.spec                 # PyInstaller配置
├── build.bat               # 打包脚本
├── requirements.txt        # 依赖列表
├── icon.svg                # 应用图标
├── .github/
│   └── workflows/
│       └── build.yml       # GitHub Actions配置
└── dist/
    └── 智能会务机票助手.exe  # 打包后的可执行文件
```

### 关键配置

- **PyInstaller配置**：`app.spec` 文件定义了打包参数
- **自动更新**：基于GitHub Releases API实现
- **版本管理**：使用语义化版本号（如v1.0.0）
- **图标设置**：支持自定义应用图标

## ⚠️ 注意事项

1. **网络要求**：自动更新功能需要网络连接
2. **权限问题**：更新时可能需要管理员权限
3. **防火墙**：确保应用可以访问GitHub API
4. **文件路径**：避免中文路径可能导致的问题

## 🐛 常见问题

### 打包失败

1. 检查Python环境和依赖是否完整
2. 确保没有语法错误
3. 检查图标文件是否存在

### 更新失败

1. 检查网络连接
2. 确认GitHub仓库信息正确
3. 检查Release是否包含exe文件

### 运行错误

1. 检查系统兼容性（Windows 10/11）
2. 尝试以管理员身份运行
3. 检查防病毒软件是否误报

## 📞 技术支持

如有问题请：
1. 检查本文档的常见问题部分
2. 查看GitHub Issues
3. 联系开发团队

---

**版本**：1.0.0  
**更新时间**：2025年1月19日  
**作者**：开发团队